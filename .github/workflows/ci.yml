
name: iOS Build and Test

on:
  pull_request:
    branches:
      - main

jobs:
  build-and-test:
    runs-on: macos-latest

  steps:
      - name: Checkout repository
        uses: actions/checkout@v2
* Puis utilisez l'action sersoft-gmbh/xcodebuild-action pour compiler l'application et exécuter les tests unitaires. Les paramètres de cette action incluent le projet Xcode, le schéma, la destination du simulateur et les paramètres de build.

          - name: Build and Test
                uses: sersoft-gmbh/xcodebuild-action@v3.2.0
            with:
               project: MediStock.xcodeproj
               scheme: pack
               destination: 'platform=iOS Simulator,name=iPhone 14'
               action: test
               result-bundle-path: 'TestResults/TestResults.xcresult'
* Enfin, utilisez l'action kishikawakatsumi/xcresulttool pour traiter les résultats des tests et générer des rapports lisibles. Nous souhaitons par ailleurs exécuter la génération de rapport, que le résultat des tests soit un succès ou non.

      - name: Process Test Results
        uses: kishikawakatsumi/xcresulttool@v1
        with:
          path: TestResults/TestResults.xcresult
        if: success() || failure()
